parameters:
  installFolderPath: "/3______________________________________________________________/i"

steps:
  - task: CacheBeta@0
    inputs:
      key: test_ESY__PREFIX_tar_i_path_cache | esy | $(Agent.OS) | esy.lock/index.json
      path: $(ESY__PREFIX)${{ parameters.installFolderPath }}
    displayName: Cache esy packages
  - template: utils/use-node.yml
  - template: utils/use-esy.yml
  - script: "esy install"
    displayName: "esy install"
  - script: "esy build"
    displayName: "esy build"
  - script: "esy dune build @fmt --root ."
    displayName: "Check code formatting"
  - template: run-tests.yml
  - script: "esy examples"
    displayName: "Build examples"
  - script: ls $(ESY__PREFIX)${{ parameters.installFolderPath }}
